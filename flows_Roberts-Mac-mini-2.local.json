[{"id":"f9337f21.0eab78","type":"tab","label":"Lights","disabled":false,"info":""},{"id":"c1c7f362.7de41","type":"subflow","name":"Time Converter","info":"","category":"","in":[{"x":140,"y":400,"wires":[{"id":"4399d4e7.f347b4"}]}],"out":[{"x":1020,"y":400,"wires":[{"id":"377e5da4.48bc92","port":0}]}],"env":[],"color":"#DDAA99","status":{"x":1020,"y":460,"wires":[{"id":"377e5da4.48bc92","port":0}]}},{"id":"3ee5091.589cff6","type":"subflow","name":"Store & Gen Color Msgs","info":"","category":"","in":[{"x":20,"y":80,"wires":[{"id":"29aee99c.dd5c3e"}]}],"out":[{"x":740,"y":80,"wires":[{"id":"e9721d05.5dd87","port":0}]}],"env":[],"color":"#DDAA99"},{"id":"252d4ef4.c14b6a","type":"hubitat config","z":"","name":"Hubitat","usetls":false,"host":"10.0.0.27","port":"80","token":"56716d1b-e436-449b-aef1-c3fb8a7c3548","appId":"501","nodeRedServer":"http://10.0.0.25:1880","webhookPath":"/hubitat/webhook"},{"id":"bbd72740.5752e8","type":"ui_tab","z":"","name":"Home","icon":"dashboard","disabled":false,"hidden":false},{"id":"6bba6383.20c05c","type":"ui_group","z":"","name":"Default","tab":"bbd72740.5752e8","disp":false,"width":"6","collapse":false},{"id":"f5be1ade.4321f8","type":"ui_base","theme":{"name":"theme-dark","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","reset":false},"themeState":{"base-color":{"default":"#097479","value":"#097479","edited":false},"page-titlebar-backgroundColor":{"value":"#097479","edited":false},"page-backgroundColor":{"value":"#111111","edited":false},"page-sidebar-backgroundColor":{"value":"#000000","edited":false},"group-textColor":{"value":"#0eb8c0","edited":false},"group-borderColor":{"value":"#555555","edited":false},"group-backgroundColor":{"value":"#333333","edited":false},"widget-textColor":{"value":"#eeeeee","edited":false},"widget-backgroundColor":{"value":"#097479","edited":false},"widget-borderColor":{"value":"#333333","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"a9e57cc4.ae8e78","type":"switch","z":"f9337f21.0eab78","name":"Time of Day","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"sunrise","vt":"flow"},{"t":"lt","v":"9.75","vt":"num"},{"t":"lt","v":"16.75","vt":"str"},{"t":"lt","v":"sunset","vt":"flow"},{"t":"lt","v":"20.75","vt":"str"},{"t":"lt","v":"22.41","vt":"str"},{"t":"gt","v":"22.41","vt":"str"}],"checkall":"false","repair":false,"outputs":7,"x":1930,"y":560,"wires":[["b40f3488.69ed48"],["c2ea27f3.939e98"],["7de2be06.6927a8"],["c2ea27f3.939e98"],["e3c3cb84.ef6ab8"],["cae35b58.597ef"],["b40f3488.69ed48"]]},{"id":"c2ea27f3.939e98","type":"change","z":"f9337f21.0eab78","name":"2900","rules":[{"t":"set","p":"payload","pt":"msg","to":"2900","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":600,"wires":[["7c7402f9.c5008c"]]},{"id":"7de2be06.6927a8","type":"change","z":"f9337f21.0eab78","name":"3500","rules":[{"t":"set","p":"payload","pt":"msg","to":"3500","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":640,"wires":[["7c7402f9.c5008c"]]},{"id":"e3c3cb84.ef6ab8","type":"change","z":"f9337f21.0eab78","name":"2600","rules":[{"t":"set","p":"payload","pt":"msg","to":"2600","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":560,"wires":[["7c7402f9.c5008c"]]},{"id":"cae35b58.597ef","type":"change","z":"f9337f21.0eab78","name":"2300","rules":[{"t":"set","p":"payload","pt":"msg","to":"2300","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":520,"wires":[["7c7402f9.c5008c"]]},{"id":"b40f3488.69ed48","type":"change","z":"f9337f21.0eab78","name":"2100","rules":[{"t":"set","p":"payload","pt":"msg","to":"2100","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":2170,"y":480,"wires":[["7c7402f9.c5008c"]]},{"id":"40b66d76.695704","type":"hubitat device","z":"f9337f21.0eab78","name":"Bulb 4","server":"252d4ef4.c14b6a","deviceId":"589","attribute":"switch","sendEvent":false,"x":910,"y":1200,"wires":[["3b895294.40fc1e"]]},{"id":"f6feeac1.313c","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"arguments","pt":"msg","to":"color_temperature","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":1300,"wires":[["ae47bc91.90b9e8","6b515b09.7fda64"]]},{"id":"6254ac96.dbc23c","type":"hubitat device","z":"f9337f21.0eab78","name":"Main Floor Couch Lamp","server":"252d4ef4.c14b6a","deviceId":"537","attribute":"switch","sendEvent":false,"x":970,"y":1300,"wires":[["ca3a5b6c.8bcad"]]},{"id":"ca3a5b6c.8bcad","type":"switch","z":"f9337f21.0eab78","name":"is on","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1180,"y":1300,"wires":[["f6feeac1.313c"]]},{"id":"ae47bc91.90b9e8","type":"hubitat command","z":"f9337f21.0eab78","d":true,"name":"Main Floor Couch Lamp","server":"252d4ef4.c14b6a","deviceId":"537","command":"setColorTemperature","commandArgs":"","x":1640,"y":1300,"wires":[[]]},{"id":"16e0e495.643b53","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"arguments","pt":"msg","to":"color_temperature","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":1400,"wires":[["ee7b994b.3d627","32febc59.0f2564"]]},{"id":"d643e945.03fd68","type":"hubitat device","z":"f9337f21.0eab78","name":"Main Floor Chair Lamp","server":"252d4ef4.c14b6a","deviceId":"536","attribute":"switch","sendEvent":false,"x":960,"y":1400,"wires":[["6626a7d5.bd4b9"]]},{"id":"6626a7d5.bd4b9","type":"switch","z":"f9337f21.0eab78","name":"is on","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1180,"y":1400,"wires":[["16e0e495.643b53"]]},{"id":"ee7b994b.3d627","type":"hubitat command","z":"f9337f21.0eab78","d":true,"name":"Main Floor Chair Lamp","server":"252d4ef4.c14b6a","deviceId":"536","command":"setColorTemperature","commandArgs":"","x":1630,"y":1400,"wires":[[]]},{"id":"a33161c6.8749e8","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"arguments","pt":"msg","to":"color_temperature","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":1500,"wires":[["7b708ee2.c9e758"]]},{"id":"48fe7158.3de628","type":"hubitat device","z":"f9337f21.0eab78","name":"Kitchen Table","server":"252d4ef4.c14b6a","deviceId":"538","attribute":"switch","sendEvent":false,"x":940,"y":1500,"wires":[["4e3c6812.be32d"]]},{"id":"4e3c6812.be32d","type":"switch","z":"f9337f21.0eab78","name":"is on","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1180,"y":1500,"wires":[["a33161c6.8749e8"]]},{"id":"7b708ee2.c9e758","type":"hubitat command","z":"f9337f21.0eab78","d":true,"name":"Kitchen Table","server":"252d4ef4.c14b6a","deviceId":"538","command":"setColorTemperature","commandArgs":"","x":1610,"y":1500,"wires":[[]]},{"id":"a9edbf38.5d73e","type":"sun events","z":"f9337f21.0eab78","testmode":false,"verbose":true,"topic":"","name":"","x":140,"y":140,"wires":[["9611c7c0.95837"]]},{"id":"784954e6.b11cdc","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"arguments","pt":"msg","to":"color_temperature","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":1200,"wires":[["2ac4b003.a7d4e8","d957de20.f4dc4"]]},{"id":"3b895294.40fc1e","type":"switch","z":"f9337f21.0eab78","name":"is on","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":1180,"y":1200,"wires":[["784954e6.b11cdc"]]},{"id":"2ac4b003.a7d4e8","type":"hubitat command","z":"f9337f21.0eab78","name":"Bulb 4","server":"252d4ef4.c14b6a","deviceId":"589","command":"setColorTemperature","commandArgs":"","x":1580,"y":1200,"wires":[[]]},{"id":"6ace0576.3d508c","type":"subflow:c1c7f362.7de41","z":"f9337f21.0eab78","name":"","env":[],"x":920,"y":560,"wires":[["5b9ee631.4051d8"]]},{"id":"3c3d7e61.eb4042","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"timestamp","pt":"msg","to":"","tot":"date"}],"action":"","property":"","from":"","to":"","reg":false,"x":450,"y":140,"wires":[["666f4f45.e0e1"]]},{"id":"31cc0e24.f3ea6a","type":"change","z":"f9337f21.0eab78","name":"epoch time","rules":[{"t":"set","p":"payload","pt":"msg","to":"","tot":"date"}],"action":"","property":"","from":"","to":"","reg":false,"x":750,"y":560,"wires":[["6ace0576.3d508c"]]},{"id":"666f4f45.e0e1","type":"switch","z":"f9337f21.0eab78","name":"sunriseEnd/sunsetStart","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"sunriseEnd","vt":"str"},{"t":"eq","v":"sunsetStart","vt":"str"},{"t":"nempty"}],"checkall":"true","repair":false,"outputs":3,"x":690,"y":140,"wires":[["535b516b.335af"],["897b4548.dc246"],[]]},{"id":"834cc3f9.1a5228","type":"change","z":"f9337f21.0eab78","name":"Flow.Sunrise","rules":[{"t":"set","p":"sunrise","pt":"flow","to":"timestamp","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1950,"y":120,"wires":[["3c2a296b.f365ce"]]},{"id":"70a7fa7c.6b0b04","type":"change","z":"f9337f21.0eab78","name":"Flow.Sunset","rules":[{"t":"set","p":"payload","pt":"msg","to":"timestamp","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1950,"y":160,"wires":[["20821ed.13169e2"]]},{"id":"1ec80815.bffb7","type":"inject","z":"f9337f21.0eab78","name":"Check Sunrise/Sunset","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":300,"wires":[["4d57a354.5430bc","2531b654.0b8fba"]]},{"id":"4d57a354.5430bc","type":"change","z":"f9337f21.0eab78","name":"flow.sunrise","rules":[{"t":"set","p":"payload","pt":"msg","to":"sunrise","tot":"flow"},{"t":"change","p":"payload","pt":"msg","from":"(.*)","fromt":"re","to":"Sunrise: \\1","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":280,"wires":[["b58ad5d3.fb8b48"]]},{"id":"2531b654.0b8fba","type":"change","z":"f9337f21.0eab78","name":"flow.sunset","rules":[{"t":"set","p":"payload","pt":"msg","to":"sunset","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":390,"y":320,"wires":[["dabfed9.52d241"]]},{"id":"91e834f2.799fc8","type":"change","z":"f9337f21.0eab78","name":"flow.sunset = 8:15","rules":[{"t":"set","p":"sunset","pt":"flow","to":"8.25","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":200,"wires":[["d8d4af33.b7381"]]},{"id":"ddd3d696.8367c","type":"change","z":"f9337f21.0eab78","name":"flow.sunrise = 6:45","rules":[{"t":"set","p":"sunrise","pt":"flow","to":"6.75","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":240,"wires":[["3199bba9.02e944"]]},{"id":"5cdb639.d7f239c","type":"inject","z":"f9337f21.0eab78","name":"Set Sunrise/Sunset","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":220,"wires":[["91e834f2.799fc8","ddd3d696.8367c"]]},{"id":"49b258f7.c125a","type":"comment","z":"f9337f21.0eab78","name":"Set and maintain the values for sunrise and sunset as flow variables","info":"","x":300,"y":60,"wires":[]},{"id":"78d27aa4.3a922c","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"color_temperature","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":2580,"y":560,"wires":[["bab11f90.99cb88","657020ce.a5a248"]]},{"id":"7c7402f9.c5008c","type":"ui_slider","z":"f9337f21.0eab78","name":"","label":"slider","tooltip":"","group":"6bba6383.20c05c","order":1,"width":0,"height":0,"passthru":true,"outs":"end","topic":"","min":"2000","max":"7400","step":"100","x":2370,"y":560,"wires":[["78d27aa4.3a922c"]]},{"id":"be0d2f98.2fa23","type":"ui_button","z":"f9337f21.0eab78","name":"","group":"6bba6383.20c05c","order":2,"width":0,"height":0,"passthru":false,"label":"Set color to automatic","tooltip":"","color":"","bgcolor":"","icon":"","payload":"","payloadType":"str","topic":"","x":160,"y":520,"wires":[["7a1e014f.2d5688"]]},{"id":"e1883f09.0ab798","type":"ui_numeric","z":"f9337f21.0eab78","name":"","label":"Hour","tooltip":"","group":"6bba6383.20c05c","order":0,"width":0,"height":0,"wrap":true,"passthru":true,"topic":"","format":"{{value}}","min":"0","max":"23","step":"1","x":1270,"y":500,"wires":[["def0dcd1.ae49f"]]},{"id":"5b9ee631.4051d8","type":"function","z":"f9337f21.0eab78","name":"-> hours, minutes","func":"hour = parseInt(msg.payload)\nminute = Math.trunc((msg.payload - hour) * 60)\n\nnode.status({text: `${hour}:${minute}`})\n\nreturn [\n    {payload: hour},\n    {payload: minute},\n    {payload: \"ping\"}\n]","outputs":3,"noerr":0,"x":1110,"y":560,"wires":[["e1883f09.0ab798","def0dcd1.ae49f"],["61f23ab5.377aa4","32146448.1c8d94"],[]]},{"id":"61f23ab5.377aa4","type":"ui_numeric","z":"f9337f21.0eab78","name":"","label":"Minute","tooltip":"","group":"6bba6383.20c05c","order":0,"width":0,"height":0,"wrap":true,"passthru":true,"topic":"","format":"{{value}}","min":"0","max":"59","step":"1","x":1270,"y":620,"wires":[["32146448.1c8d94"]]},{"id":"def0dcd1.ae49f","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"hour","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1410,"y":520,"wires":[["e65b54ea.fdec1"]]},{"id":"32146448.1c8d94","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"minute","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1420,"y":600,"wires":[["e65b54ea.fdec1"]]},{"id":"e65b54ea.fdec1","type":"function","z":"f9337f21.0eab78","name":"Accumulate time","func":"if (msg.hour) {\n    context.set(\"hour\", msg.hour)\n}\n\nif (msg.minute) {\n    context.set(\"minute\", msg.minute)\n}\n\nminute = context.get(\"minute\") || 1\nhour = context.get(\"hour\") || 12\n\nmsg.payload = hour + (minute / 60)\n\nnode.status({text: `${hour}:${minute} -> ${msg.payload}` })\n\nreturn msg;","outputs":1,"noerr":0,"x":1650,"y":560,"wires":[["a9e57cc4.ae8e78","1ddf78db.23577f"]]},{"id":"65b86934.6a3848","type":"sort","z":"3ee5091.589cff6","name":"","order":"ascending","as_num":true,"target":"","targetType":"seq","msgKey":"","msgKeyType":"elem","seqKey":"parts.index","seqKeyType":"msg","x":410,"y":80,"wires":[["e9721d05.5dd87"]]},{"id":"e9721d05.5dd87","type":"delay","z":"3ee5091.589cff6","name":"","pauseType":"delay","timeout":"50","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":570,"y":80,"wires":[[]]},{"id":"29aee99c.dd5c3e","type":"function","z":"3ee5091.589cff6","name":"Store and Gen Color/CT Info","func":"pylName = msg.payload.name;\npylValue = (msg.payload.value === undefined?\"\":msg.payload.value);\n\n//node.warn('--------------------start func');\n\nasync function sendCmdMsg(message,cmd,args,parts) {\n    \n    node.warn(\"sending = \" + cmd + \" / \" + args );\n    message.command = cmd;\n    message.arguments = args;\n    message.payload = {};\n    message.parts = parts;\n    node.send(message);\n    node.done();\n}\n\n// \nvarName = \"$parent.\" + msg.topic + \"_attributes\";\nattrs = {};\n\nif(!flow.get(varName)){\n\tattrs = {\n\t\tswitch:{command:\"switch\",arguments:\"\"},\n\t\thue:{command:\"setHue\",arguments:\"\"},\n\t\tsaturation:{command:\"setSaturation\",arguments:\"\"},\n\t\tlevel:{command:\"setLevel\",arguments:\"\"},\n\t\tcolorTemperature:{command:\"setColorTemperature\",arguments:\"\"},\n\t\tcolorMode:{command:\"setColorMode\",arguments:\"\"}\n\t}\n} else  {\n\tattrs = flow.get(varName);\n}\n\n\n// Accumulate necessary commands from events..\nattrs[pylName].arguments = pylValue;\nflow.set(varName,attrs);\n\n//node.warn(attrs)\n\nif (checkAttrs(attrs) ) {\n\tcmds = [];\n\t\n    \n\tif (attrs.switch.arguments == \"on\") {\n\t\t\n\t\tswitch(attrs.colorMode.arguments) {\n\t\t\tcase \"CT\":\n\t\t\t\t//node.warn(\"********************  CT Mode\");\n\t\t\t\tcmds = [ \n\t\t\t\t\t{cmd:attrs.colorTemperature.command,arguments:attrs.colorTemperature.arguments},\n\t\t\t\t\t{cmd:attrs.level.command,arguments:attrs.level.arguments},\n\t\t\t\t\t{cmd:attrs.switch.arguments}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t\n\t\t\tcase \"RGB\":\n\t\t\t\t//node.warn(\"********************  RGB Mode\");\n\t\t\t\tcmds = [\n\t\t\t\t\t{cmd:attrs.hue.command,arguments:attrs.hue.arguments},\n\t\t\t\t\t{cmd:attrs.saturation.command,arguments:attrs.saturation.arguments},\n\t\t\t\t\t{cmd:attrs.level.command,arguments:attrs.level.arguments},\n\t\t\t\t\t{cmd:attrs.switch.arguments}\n\t\t\t\t];\n\t\t\t\tbreak;\n\t\t}\n\t}\n\telse {\n\t\t\tcmds = [ \n\t\t\t\t{cmd:attrs.switch.arguments}\n\t\t\t];\n\t}\n    \n    //node.warn(cmds);\n    \n\tcmds.forEach((cmd, index, aCmds) => {\n        parts = { id:msg._msgid, index:index, count:aCmds.length};\n    \tsendCmdMsg(msg,cmd.cmd,cmd.arguments,parts);\n\t});\n\t\n\t\n\t// zap attrs\n\tflow.set(varName,undefined);\n}\n\n//node.warn('--------------------end func');\n\nreturn;\n\n\nfunction checkAttrs(attrs) {\n\t// make sure all attributes are filled for colorMode, if so return true!\n\tdataOkay = false;\n\t//node.warn(attrs.colorMode);\n\t\n\tswitch(attrs.colorMode.arguments) {\n\t\tcase \"CT\":\n\t\t\tdataOkay = ( \n\t\t\t    attrs.colorTemperature.arguments !== \"\" && \n\t\t\t    attrs.level.arguments !== \"\" && \n\t\t\t    attrs.switch.arguments !== \"\" \n\t\t\t);\n\t\t\t//node.warn(\"CT = \" + dataOkay);\n\t\t\tbreak;\n\t\tcase \"RGB\":\n\t\t\tdataOkay = ( \n\t\t\t    attrs.hue.arguments !== \"\" && \n\t\t\t    attrs.saturation.arguments !== \"\" && \n\t\t\t    attrs.level.arguments !== \"\"  && \n\t\t\t    attrs.switch.arguments !== \"\" \n\t\t\t);\n\t\t\t//node.warn(\"RGB = \" + dataOkay);\n\t\t\tbreak;\n\t}\n\n\t//if (dataOkay) node.warn(attrs);\n\t\n\treturn dataOkay;\n}","outputs":1,"noerr":0,"x":200,"y":80,"wires":[["65b86934.6a3848"]]},{"id":"e1e38786.f7807","type":"inject","z":"f9337f21.0eab78","name":"Every 15 minutes","topic":"","payload":"","payloadType":"date","repeat":"900","crontab":"","once":true,"onceDelay":0.1,"x":150,"y":480,"wires":[["7a1e014f.2d5688"]]},{"id":"e19e918a.2851d","type":"hubitat mode","z":"f9337f21.0eab78","name":"","server":"252d4ef4.c14b6a","sendEvent":true,"x":110,"y":560,"wires":[["7a1e014f.2d5688"]]},{"id":"270967e9.fb6238","type":"hubitat device","z":"f9337f21.0eab78","name":"Bulb 4","server":"252d4ef4.c14b6a","deviceId":"589","attribute":"switch","sendEvent":true,"x":110,"y":620,"wires":[["43e9bb67.7e2ef4"]]},{"id":"7a1e014f.2d5688","type":"delay","z":"f9337f21.0eab78","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":550,"y":560,"wires":[["31cc0e24.f3ea6a"]]},{"id":"43e9bb67.7e2ef4","type":"switch","z":"f9337f21.0eab78","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":290,"y":620,"wires":[["7a1e014f.2d5688"]]},{"id":"5d7e751.ed4158c","type":"switch","z":"f9337f21.0eab78","name":"","property":"value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":290,"y":680,"wires":[["7a1e014f.2d5688"]]},{"id":"ec812949.416a98","type":"hubitat device","z":"f9337f21.0eab78","name":"Chair","server":"252d4ef4.c14b6a","deviceId":"536","attribute":"switch","sendEvent":true,"x":110,"y":680,"wires":[["5d7e751.ed4158c"]]},{"id":"a6be0061.f0f1e8","type":"switch","z":"f9337f21.0eab78","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":290,"y":740,"wires":[["7a1e014f.2d5688"]]},{"id":"19fe14c3.4c36fb","type":"hubitat device","z":"f9337f21.0eab78","name":"Couch","server":"252d4ef4.c14b6a","deviceId":"537","attribute":"switch","sendEvent":true,"x":110,"y":740,"wires":[["a6be0061.f0f1e8"]]},{"id":"2563e409.c0d174","type":"switch","z":"f9337f21.0eab78","name":"","property":"payload.value","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":290,"y":800,"wires":[["7a1e014f.2d5688"]]},{"id":"a10b70c1.f8ac6","type":"hubitat device","z":"f9337f21.0eab78","name":"Kitchen Table","server":"252d4ef4.c14b6a","deviceId":"536","attribute":"switch","sendEvent":true,"x":140,"y":800,"wires":[["2563e409.c0d174"]]},{"id":"6b515b09.7fda64","type":"debug","z":"f9337f21.0eab78","d":true,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1590,"y":1260,"wires":[]},{"id":"32febc59.0f2564","type":"debug","z":"f9337f21.0eab78","d":true,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1590,"y":1360,"wires":[]},{"id":"d957de20.f4dc4","type":"debug","z":"f9337f21.0eab78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":1590,"y":1160,"wires":[]},{"id":"8ffc333a.c9e7e","type":"inject","z":"f9337f21.0eab78","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":920,"y":1140,"wires":[["40b66d76.695704"]]},{"id":"971e2447.ec8f88","type":"inject","z":"f9337f21.0eab78","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":1940,"y":640,"wires":[["b40f3488.69ed48"]]},{"id":"1ddf78db.23577f","type":"debug","z":"f9337f21.0eab78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1930,"y":480,"wires":[]},{"id":"bab11f90.99cb88","type":"debug","z":"f9337f21.0eab78","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":2790,"y":560,"wires":[]},{"id":"657020ce.a5a248","type":"delay","z":"f9337f21.0eab78","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"milliseconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":730,"y":1200,"wires":[["40b66d76.695704","6254ac96.dbc23c","d643e945.03fd68","48fe7158.3de628"]]},{"id":"d8d4af33.b7381","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":200,"wires":[]},{"id":"3199bba9.02e944","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":240,"wires":[]},{"id":"b58ad5d3.fb8b48","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":550,"y":280,"wires":[]},{"id":"dabfed9.52d241","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":550,"y":320,"wires":[]},{"id":"9611c7c0.95837","type":"switch","z":"f9337f21.0eab78","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"sunsetStart","vt":"str"},{"t":"eq","v":"sunriseEnd","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":270,"y":140,"wires":[["3c3d7e61.eb4042"],["3c3d7e61.eb4042"]]},{"id":"7d83412b.5d9378","type":"subflow:c1c7f362.7de41","z":"f9337f21.0eab78","name":"","env":[],"x":1340,"y":140,"wires":[["31a43653.b06c72"]]},{"id":"25eec13d.3a6c9e","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"sunEvent","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"timestamp","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1160,"y":140,"wires":[["7d83412b.5d9378"]]},{"id":"31a43653.b06c72","type":"change","z":"f9337f21.0eab78","name":"","rules":[{"t":"set","p":"timestamp","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"sunEvent","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":1520,"y":140,"wires":[["96419e57.f29ac"]]},{"id":"96419e57.f29ac","type":"switch","z":"f9337f21.0eab78","name":"sunriseEnd/sunsetStart","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"sunriseEnd","vt":"str"},{"t":"eq","v":"sunsetStart","vt":"str"},{"t":"nempty"}],"checkall":"true","repair":false,"outputs":3,"x":1730,"y":140,"wires":[["834cc3f9.1a5228"],["70a7fa7c.6b0b04"],[]]},{"id":"3c2a296b.f365ce","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":2110,"y":120,"wires":[]},{"id":"20821ed.13169e2","type":"debug","z":"f9337f21.0eab78","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":2110,"y":160,"wires":[]},{"id":"4399d4e7.f347b4","type":"calculator","z":"c1c7f362.7de41","name":"/ 1000","inputMsgField":"payload","outputMsgField":"payload","operation":"div","constant":"1000","x":230,"y":400,"wires":[["d7e02d77.dd5358"]]},{"id":"d7e02d77.dd5358","type":"calculator","z":"c1c7f362.7de41","name":"- 3600 * 6","inputMsgField":"payload","outputMsgField":"payload","operation":"sub","constant":"21600","x":380,"y":400,"wires":[["60362c7d.d53ad4"]]},{"id":"60362c7d.d53ad4","type":"calculator","z":"c1c7f362.7de41","name":"% 86400","inputMsgField":"payload","outputMsgField":"payload","operation":"mod","constant":"86400","x":580,"y":400,"wires":[["377e5da4.48bc92"]]},{"id":"aa0d64a0.a2b408","type":"comment","z":"c1c7f362.7de41","name":"Time Zone Offset","info":"","x":400,"y":360,"wires":[]},{"id":"a0e70412.49cd3","type":"comment","z":"c1c7f362.7de41","name":"ms -> s","info":"","x":230,"y":360,"wires":[]},{"id":"f207fd86.a5521","type":"comment","z":"c1c7f362.7de41","name":"seconds since midnight","info":"","x":620,"y":360,"wires":[]},{"id":"377e5da4.48bc92","type":"calculator","z":"c1c7f362.7de41","name":"/ 3600","inputMsgField":"payload","outputMsgField":"payload","operation":"div","constant":"3600","x":850,"y":400,"wires":[[]]},{"id":"ba6ff9d9.4f1458","type":"comment","z":"c1c7f362.7de41","name":"hours since midnight","info":"","x":890,"y":360,"wires":[]},{"id":"535b516b.335af","type":"calculator","z":"f9337f21.0eab78","name":"Add 35min","inputMsgField":"payload","outputMsgField":"payload","operation":"sum","constant":"2100000","x":930,"y":120,"wires":[["25eec13d.3a6c9e"]]},{"id":"897b4548.dc246","type":"calculator","z":"f9337f21.0eab78","name":"Subtract 60min","inputMsgField":"payload","outputMsgField":"payload","operation":"sub","constant":"3600000","x":940,"y":160,"wires":[["25eec13d.3a6c9e"]]}]